<h1 class="text-xl font-bold"> <%= t('orders.index.title') %> </h1>

<div class="mb-4">
  <%= link_to t('orders.index.new_order'), new_order_path, class: "bg-green-500 text-white px-4 py-2 rounded" %>
</div>

<%= form_with url: orders_path, method: :get, local: true, class: "mb-4" do |f| %>
  <div class="bg-white shadow overflow-hidden sm:rounded-lg p-6">
    <h2 class="text-2xl font-semibold mb-4"><%= t('orders.filters.title') %></h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <%= f.label :customer_name, t('orders.filters.customer_name'), class: "block text-sm font-medium text-gray-700" %>
        <%= f.text_field :customer_name, name: "filters[customer_name]", value: params.dig(:filters, :customer_name), class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm" %>
      </div>
      <div>
        <%= f.label :status, t('orders.filters.status'), class: "block text-sm font-medium text-gray-700" %>
        <%= f.select :status,
              options_for_select(Order::STATUS.map { |s| [s.humanize, s] }, params.dig(:filters, :status)),
              { include_blank: t('orders.filters.select_status') },
              { name: "filters[status]", class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm" } %>
      </div>
    </div>

    <div class="mt-4">
      <button type="button" id="toggleAdvanced" class="text-blue-600 hover:underline">
        <%= t('orders.filters.advanced_filters') %>
      </button>
    </div>

    <div id="advancedFilters" class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
      <div>
        <%= f.label :from_date, t('orders.filters.from_date'), class: "block text-sm font-medium text-gray-700" %>
        <%= f.date_field :from_date, name: "filters[from_date]", value: params.dig(:filters, :from_date), class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm" %>
      </div>
      <div>
        <%= f.label :to_date, t('orders.filters.to_date'), class: "block text-sm font-medium text-gray-700" %>
        <%= f.date_field :to_date, name: "filters[to_date]", value: params.dig(:filters, :to_date), class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm" %>
      </div>
      <div>
        <%= f.label :product_name, t('orders.filters.product_name'), class: "block text-sm font-medium text-gray-700" %>
        <%= f.text_field :product_name, name: "filters[product_name]", value: params.dig(:filters, :product_name), class: "mt-1 block w-full rounded-md border-gray-300 shadow-sm" %>
      </div>
    </div>

    <div class="mt-6 flex gap-2">
      <%= f.submit t('orders.filters.search'), class: "inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700" %>

      <%= link_to t('orders.filters.clear'), orders_path, class: "inline-flex justify-center py-2 px-4 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-100" %>
    </div>
  </div>
<% end %>

<table class="w-full border">
  <thead>
    <tr>
      <th class="border px-4 py-2">ID</th>
      <th class="border px-4 py-2">Customer</th>
      <th class="border px-4 py-2">Product</th>
      <th class="border px-4 py-2">Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @orders.each do |order| %>
      <tr>
        <td class="border px-4 py-2"><%= order.id %></td>
        <td class="border px-4 py-2"><%= order.customer_name %></td>
        <td class="border px-4 py-2"><%= order.product.name %></td>
        <td class="border px-4 py-2">
          <%= link_to 'Edit', edit_order_path(order), class: "text-yellow-500" %>
          <%= button_to 'Delete', order, method: :delete, data: { confirm: t('orders.destroy.confirm') }, class: "text-red-500" %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= render 'shared/paginator', collection: @orders %>
